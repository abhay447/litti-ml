package com.litti.ml.feature;

import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;

import com.google.common.reflect.TypeToken;
import com.google.gson.Gson;
import com.litti.ml.feature.store.FeatureStoreRecord;
import java.util.Map;
import org.junit.jupiter.api.Test;

public class TestFeatureStoreRead {

  @Test
  public void testFeatureStoreRecordRead() {
    String rawRedisValue =
        "{\"balls_faced_90D#v1\":{\"featureName\":\"balls_faced_90D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"deliveries_30D#v1\":{\"featureName\":\"deliveries_30D\",\"featureVersion\":\"v1\",\"rawValue\":26,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_sr_300D#v1\":{\"featureName\":\"bowling_sr_300D\",\"featureVersion\":\"v1\",\"rawValue\":16.5,\"validFrom\":1677925836,\"validTo\":1678012236},\"batter_runs_300D#v1\":{\"featureName\":\"batter_runs_300D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"total_runs_300D#v1\":{\"featureName\":\"total_runs_300D\",\"featureVersion\":\"v1\",\"rawValue\":185,\"validFrom\":1677925836,\"validTo\":1678012236},\"deliveries_1000D#v1\":{\"featureName\":\"deliveries_1000D\",\"featureVersion\":\"v1\",\"rawValue\":259,\"validFrom\":1677925836,\"validTo\":1678012236},\"six_count_1000D_venue#v1\":{\"featureName\":\"six_count_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"wicket_sum_1000D_venue#v1\":{\"featureName\":\"wicket_sum_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":1,\"validFrom\":1677925836,\"validTo\":1678012236},\"is_male#v1\":{\"featureName\":\"is_male\",\"featureVersion\":\"v1\",\"rawValue\":1,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_avg_1000D#v1\":{\"featureName\":\"bowling_avg_1000D\",\"featureVersion\":\"v1\",\"rawValue\":18.6875,\"validFrom\":1677925836,\"validTo\":1678012236},\"maiden_count_1000D_venue#v1\":{\"featureName\":\"maiden_count_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"balls_faced_30D#v1\":{\"featureName\":\"balls_faced_30D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_eco_30D#v1\":{\"featureName\":\"bowling_eco_30D\",\"featureVersion\":\"v1\",\"rawValue\":7.384615384615385,\"validFrom\":1677925836,\"validTo\":1678012236},\"six_count_1000D#v1\":{\"featureName\":\"six_count_1000D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_sr_300D#v1\":{\"featureName\":\"batting_sr_300D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"fielding_wicket_sum#v1\":{\"featureName\":\"fielding_wicket_sum\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"dismissals_300D#v1\":{\"featureName\":\"dismissals_300D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"balls_faced_300D#v1\":{\"featureName\":\"balls_faced_300D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"maiden_count_1000D#v1\":{\"featureName\":\"maiden_count_1000D\",\"featureVersion\":\"v1\",\"rawValue\":2,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_avg_1000D#v1\":{\"featureName\":\"batting_avg_1000D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_avg_300D#v1\":{\"featureName\":\"bowling_avg_300D\",\"featureVersion\":\"v1\",\"rawValue\":18.5,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_eco_300D#v1\":{\"featureName\":\"bowling_eco_300D\",\"featureVersion\":\"v1\",\"rawValue\":6.7272727272727275,\"validFrom\":1677925836,\"validTo\":1678012236},\"boundary_count_1000D_venue#v1\":{\"featureName\":\"boundary_count_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_sr_1000D_venue#v1\":{\"featureName\":\"bowling_sr_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":26.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"boundary_count_90D#v1\":{\"featureName\":\"boundary_count_90D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_sr_1000D_venue#v1\":{\"featureName\":\"batting_sr_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"wicket_sum_300D#v1\":{\"featureName\":\"wicket_sum_300D\",\"featureVersion\":\"v1\",\"rawValue\":10,\"validFrom\":1677925836,\"validTo\":1678012236},\"boundary_count_30D#v1\":{\"featureName\":\"boundary_count_30D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"boundary_count_1000D#v1\":{\"featureName\":\"boundary_count_1000D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batter_runs_1000D#v1\":{\"featureName\":\"batter_runs_1000D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"balls_faced_1000D_venue#v1\":{\"featureName\":\"balls_faced_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"wicket_sum_90D#v1\":{\"featureName\":\"wicket_sum_90D\",\"featureVersion\":\"v1\",\"rawValue\":1,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_eco_1000D_venue#v1\":{\"featureName\":\"bowling_eco_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":7.384615384615385,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_avg_90D#v1\":{\"featureName\":\"batting_avg_90D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_avg_300D#v1\":{\"featureName\":\"batting_avg_300D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"total_runs_30D#v1\":{\"featureName\":\"total_runs_30D\",\"featureVersion\":\"v1\",\"rawValue\":32,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_avg_1000D_venue#v1\":{\"featureName\":\"bowling_avg_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":32.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"total_runs_90D#v1\":{\"featureName\":\"total_runs_90D\",\"featureVersion\":\"v1\",\"rawValue\":32,\"validFrom\":1677925836,\"validTo\":1678012236},\"wicket_sum_30D#v1\":{\"featureName\":\"wicket_sum_30D\",\"featureVersion\":\"v1\",\"rawValue\":1,\"validFrom\":1677925836,\"validTo\":1678012236},\"batter_runs_30D#v1\":{\"featureName\":\"batter_runs_30D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_avg_30D#v1\":{\"featureName\":\"batting_avg_30D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_avg_1000D_venue#v1\":{\"featureName\":\"batting_avg_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"deliveries_1000D_venue#v1\":{\"featureName\":\"deliveries_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":26,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_avg_30D#v1\":{\"featureName\":\"bowling_avg_30D\",\"featureVersion\":\"v1\",\"rawValue\":32.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"deliveries_300D#v1\":{\"featureName\":\"deliveries_300D\",\"featureVersion\":\"v1\",\"rawValue\":165,\"validFrom\":1677925836,\"validTo\":1678012236},\"dismissals_1000D#v1\":{\"featureName\":\"dismissals_1000D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"wicket_sum_1000D#v1\":{\"featureName\":\"wicket_sum_1000D\",\"featureVersion\":\"v1\",\"rawValue\":16,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_sr_30D#v1\":{\"featureName\":\"batting_sr_30D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"six_count_30D#v1\":{\"featureName\":\"six_count_30D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batter_runs_90D#v1\":{\"featureName\":\"batter_runs_90D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_sr_1000D#v1\":{\"featureName\":\"batting_sr_1000D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"maiden_count_300D#v1\":{\"featureName\":\"maiden_count_300D\",\"featureVersion\":\"v1\",\"rawValue\":1,\"validFrom\":1677925836,\"validTo\":1678012236},\"batting_sr_90D#v1\":{\"featureName\":\"batting_sr_90D\",\"featureVersion\":\"v1\",\"rawValue\":0.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"maiden_count_30D#v1\":{\"featureName\":\"maiden_count_30D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"total_runs_1000D#v1\":{\"featureName\":\"total_runs_1000D\",\"featureVersion\":\"v1\",\"rawValue\":299,\"validFrom\":1677925836,\"validTo\":1678012236},\"dismissals_1000D_venue#v1\":{\"featureName\":\"dismissals_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"maiden_count_90D#v1\":{\"featureName\":\"maiden_count_90D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"batter_runs_1000D_venue#v1\":{\"featureName\":\"batter_runs_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_sr_1000D#v1\":{\"featureName\":\"bowling_sr_1000D\",\"featureVersion\":\"v1\",\"rawValue\":16.1875,\"validFrom\":1677925836,\"validTo\":1678012236},\"boundary_count_300D#v1\":{\"featureName\":\"boundary_count_300D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"six_count_300D#v1\":{\"featureName\":\"six_count_300D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"six_count_90D#v1\":{\"featureName\":\"six_count_90D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"dismissals_30D#v1\":{\"featureName\":\"dismissals_30D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_sr_30D#v1\":{\"featureName\":\"bowling_sr_30D\",\"featureVersion\":\"v1\",\"rawValue\":26.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"dismissals_90D#v1\":{\"featureName\":\"dismissals_90D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_avg_90D#v1\":{\"featureName\":\"bowling_avg_90D\",\"featureVersion\":\"v1\",\"rawValue\":32.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_eco_90D#v1\":{\"featureName\":\"bowling_eco_90D\",\"featureVersion\":\"v1\",\"rawValue\":7.384615384615385,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_sr_90D#v1\":{\"featureName\":\"bowling_sr_90D\",\"featureVersion\":\"v1\",\"rawValue\":26.0,\"validFrom\":1677925836,\"validTo\":1678012236},\"total_runs_1000D_venue#v1\":{\"featureName\":\"total_runs_1000D_venue\",\"featureVersion\":\"v1\",\"rawValue\":32,\"validFrom\":1677925836,\"validTo\":1678012236},\"bowling_eco_1000D#v1\":{\"featureName\":\"bowling_eco_1000D\",\"featureVersion\":\"v1\",\"rawValue\":6.926640926640927,\"validFrom\":1677925836,\"validTo\":1678012236},\"balls_faced_1000D#v1\":{\"featureName\":\"balls_faced_1000D\",\"featureVersion\":\"v1\",\"rawValue\":0,\"validFrom\":1677925836,\"validTo\":1678012236},\"deliveries_90D#v1\":{\"featureName\":\"deliveries_90D\",\"featureVersion\":\"v1\",\"rawValue\":26,\"validFrom\":1677925836,\"validTo\":1678012236}}";
    Gson gson = new Gson();
    final Map<String, FeatureStoreRecord> featureStoreRecords =
        gson.fromJson(rawRedisValue, new TypeToken<Map<String, FeatureStoreRecord>>() {}.getType());
    assertNotNull(featureStoreRecords);
    assertTrue(featureStoreRecords.size() > 10);
    System.out.println(featureStoreRecords);
    assertTrue(
        featureStoreRecords.get("balls_faced_90D#v1").getFeatureName().equals("balls_faced_90D"));
  }
}
